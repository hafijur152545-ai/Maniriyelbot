<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Maniriyel Bot</title>

<!-- Monetag -->
<script src='//libtl.com/sdk.js' data-zone='10390731' data-sdk='show_10390731'></script>

<!-- Adexora -->
<script src="https://adexora.com/cdn/ads.js?id=1551"></script>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body{margin:0;font-family:Segoe UI,sans-serif;background:#f2f4ff;padding-bottom:120px}
.header{background:linear-gradient(135deg,#6d5dfc,#8f9bff);color:#fff;padding:20px;border-radius:0 0 25px 25px}
.card{background:#fff;margin:15px;padding:20px;border-radius:20px;box-shadow:0 10px 25px rgba(0,0,0,.1)}
.balance{font-size:36px;font-weight:700}

/* BUTTON COLORS */
.btn{width:100%;padding:15px;margin-top:12px;border:none;border-radius:14px;font-size:16px;color:#fff}
.btn-monetag{background:linear-gradient(135deg,#ff9800,#ff5722)}
.btn-adexora{background:linear-gradient(135deg,#00c853,#009688)}
.btn-withdraw{background:#2f3437}
.btn-ref{background:#3f51b5}

input,select{width:100%;padding:12px;margin-top:10px;border-radius:10px;border:1px solid #ccc}

.screen{display:none}
.screen.active{display:block}

.nav{position:fixed;bottom:10px;left:10px;right:10px;background:#2f3437;border-radius:20px;padding:12px;display:flex;justify-content:space-around;color:#bbb}
.nav span{font-size:22px}
.nav .active{color:#fff}
</style>
</head>

<body>

<div class="header">
  <h2>ğŸ’° Earn Money Bot</h2>
  <small id="userInfo">User</small>
</div>

<!-- HOME -->
<div id="home" class="screen active">
  <div class="card">
    <div class="balance" id="balance">0.00 à§³</div>
    <small>Total Balance</small>
  </div>
  <div class="card">
    <button class="btn btn-ref" onclick="copyReferral()">ğŸ‘¥ Referral Link</button>
  </div>
</div>

<!-- EARN -->
<div id="earn" class="screen">
  <div class="card">
    <button class="btn btn-monetag" onclick="watchMonetag()">ğŸ“º Watch Ad (Monetag +0.7à§³)</button>
    <button class="btn btn-adexora" onclick="watchAdexora()">ğŸ¥ Watch Ad (Adexora +0.7à§³)</button>
  </div>
</div>

<!-- WITHDRAW -->
<div id="withdraw" class="screen">
  <div class="card">
    <h3>ğŸ’¸ Withdraw</h3>
    <select id="method">
      <option value="">Select Method</option>
      <option>Bkash</option>
      <option>Nagad</option>
      <option>Rocket</option>
    </select>
    <input id="number" placeholder="Payment Number">
    <input id="amount" type="number" placeholder="Amount">
    <button class="btn btn-withdraw" onclick="submitWithdraw()">Submit Withdraw</button>
  </div>
</div>

<!-- HISTORY -->
<div id="history" class="screen">
  <div class="card">
    <h3>ğŸ§¾ History</h3>
    <div id="historyList">No history</div>
  </div>
</div>

<!-- NAV -->
<div class="nav">
  <span onclick="showScreen('home',this)" class="active">ğŸ </span>
  <span onclick="showScreen('earn',this)">ğŸ¬</span>
  <span onclick="showScreen('withdraw',this)">ğŸ’¸</span>
  <span onclick="showScreen('history',this)">ğŸ§¾</span>
</div>

<script>
/* CONFIG */
const BOT_TOKEN="8547593478:AAHfAaZNdh6-gii36zff0DqIAxuuuHQUwd0";
const ADMIN_ID="6560485203";
const AD_REWARD=0.7;
const REF_PERCENT=0.10;
const MIN_WITHDRAW=20;

const tg=window.Telegram.WebApp;
tg.expand();

let user=tg.initDataUnsafe.user;
let balance=Number(localStorage.getItem("balance")||0);
let history=JSON.parse(localStorage.getItem("history")||"[]");

balanceEl.innerText=balance.toFixed(2)+" à§³";
userInfo.innerText=user.first_name+" | ID:"+user.id;

/* REF */
let refId=new URLSearchParams(window.location.search).get("start");
if(refId && !localStorage.getItem("referred")){
  localStorage.setItem("referred",refId);
}

/* NAV */
function showScreen(id,el){
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.querySelectorAll(".nav span").forEach(n=>n.classList.remove("active"));
  el.classList.add("active");
}

/* BALANCE */
function addBalance(){
  balance+=AD_REWARD;
  localStorage.setItem("balance",balance);
  balanceEl.innerText=balance.toFixed(2)+" à§³";

  if(localStorage.getItem("referred")){
    let bonus=(AD_REWARD*REF_PERCENT).toFixed(2);
    fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${ADMIN_ID}&text=`+
    encodeURIComponent(`Referral Bonus\nReferrer:${localStorage.getItem("referred")}\nBonus:${bonus}à§³`));
  }
}

/* MONETAG */
function watchMonetag(){
  if(typeof show_10390731!=="function"){
    alert("Monetag not ready");
    return;
  }
  show_10390731().then(()=>{
    addBalance();
    alert("âœ… Ad watched successfully!");
  });
}

/* ADEXORA */
function watchAdexora(){
  if(typeof showAdexora!=="function"){
    alert("Adexora not supported here");
    return;
  }
  showAdexora()
  .then(()=>{
    addBalance();
    alert("âœ… Ad watched successfully!");
  })
  .catch(()=>{
    alert("âŒ Ad not available now, try later");
  });
}

/* WITHDRAW */
function submitWithdraw(){
  let m=method.value,n=number.value,a=Number(amount.value);
  if(!m||!n||!a)return alert("Fill all");
  if(a<MIN_WITHDRAW)return alert("Minimum 20à§³");
  if(a>balance)return alert("Low balance");

  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${ADMIN_ID}&text=`+
  encodeURIComponent(`Withdraw\nUser:${user.id}\n${m}\n${n}\nAmount:${a}à§³`));

  balance-=a;
  localStorage.setItem("balance",balance);
  balanceEl.innerText=balance.toFixed(2)+" à§³";

  history.push(`${m} | ${a}à§³`);
  localStorage.setItem("history",JSON.stringify(history));
  renderHistory();
  alert("Withdraw request sent");
}

/* HISTORY */
function renderHistory(){
  historyList.innerHTML=history.length
    ? history.map(h=>`<p>${h}</p>`).join("")
    : "No history";
}
renderHistory();

/* REF LINK */
function copyReferral(){
  let link=`https://t.me/maniriyel_bot?start=${user.id}`;
  navigator.clipboard.writeText(link);
  alert("Referral link copied");
}
</script>
</body>
</html>
