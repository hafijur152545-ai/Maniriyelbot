<!DOCTYPE html>

<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telegram Mini App</title>

<!-- ========= AD NETWORK ========= -->

<script src='//libtl.com/sdk.js' data-zone='10390731' data-sdk='show_10390731'></script>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<!-- ============================== -->

<style>
body{margin:0;font-family:Segoe UI,sans-serif;background:#f2f4ff}
.header{background:linear-gradient(135deg,#6d5dfc,#8f9bff);color:#fff;padding:20px;border-radius:0 0 25px 25px}
.card{background:#fff;margin:15px;padding:20px;border-radius:20px;box-shadow:0 10px 25px rgba(0,0,0,.1)}
.balance{font-size:36px;font-weight:700}
.btn{width:100%;padding:14px;margin-top:10px;border:none;border-radius:14px;background:#2f3437;color:#fff;font-size:16px}
.input{width:100%;padding:14px;margin-top:10px;border-radius:14px;border:1px solid #ccc;font-size:15px}
.nav{position:fixed;bottom:10px;left:10px;right:10px;background:#2f3437;border-radius:20px;padding:12px;display:flex;justify-content:space-around;color:#bbb}
.nav span{font-size:22px}
.active{color:#fff}
</style>

</head>

<body>

<div class="header">
  <h2>üí∞ Earn Money Bot</h2>
  <small id="userInfo">User</small>
</div>

<div class="card">
  <div class="balance" id="balance">0.00 ‡ß≥</div>
  <small>Total Balance</small>
</div>

<div class="card">
  <button class="btn" onclick="watchAd()">üì∫ Watch Ad (+2‡ß≥)</button>
  <button class="btn" onclick="openWithdraw()">üí∏ Withdraw</button>
  <button class="btn" onclick="referral()">üë• Referral</button>
</div>

<!-- Withdraw Form -->

<div class="card" id="withdrawBox" style="display:none">
  <h3>üí∏ Withdraw</h3>

  <select id="method" class="input">
    <option value="">Select Method</option>
    <option value="Bkash">Bkash</option>
    <option value="Nagad">Nagad</option>
    <option value="Rocket">Rocket</option>
  </select>

  <input id="number" class="input" placeholder="Account Number">
  <input id="amount" class="input" placeholder="Amount">

<button class="btn" onclick="submitWithdraw()">Submit Withdraw</button>

</div>

<div class="nav">
  <span class="active">üè†</span>
  <span>üí∞</span>
  <span>üë§</span>
</div>

<script>
const BOT_TOKEN = "8547593478:AAHfAaZNdh6-gii36zff0DqIAxuuuHQUwd0";
const ADMIN_ID = "6560485203";
const AD_REWARD = 2;

const tg = window.Telegram.WebApp;
tg.expand();

let balance = Number(localStorage.getItem("balance") || 0);
document.getElementById("balance").innerText = balance.toFixed(2)+" ‡ß≥";

if (tg.initDataUnsafe.user){
  document.getElementById("userInfo").innerText =
    tg.initDataUnsafe.user.first_name + " | ID: " + tg.initDataUnsafe.user.id;
}

function watchAd(){
  if (typeof window.show_10390731 !== "function"){
    alert("Ad not ready");
    return;
  }
  window.show_10390731().then(()=>{
    balance += AD_REWARD;
    localStorage.setItem("balance", balance);
    document.getElementById("balance").innerText = balance.toFixed(2)+" ‡ß≥";
  });
}

function openWithdraw(){
  document.getElementById("withdrawBox").style.display = "block";
}

function submitWithdraw(){
  const method = document.getElementById("method").value;
  const number = document.getElementById("number").value;
  const amount = Number(document.getElementById("amount").value);

  if (!method || !number || !amount){
    alert("‡¶∏‡¶¨ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßã");
    return;
  }

  if (amount < 20){
    alert("Minimum withdraw 20‡ß≥");
    return;
  }

  if (amount > balance){
    alert("‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶§ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶®‡ßá‡¶á");
    return;
  }

  const msg =
`Withdraw Request
User ID: ${tg.initDataUnsafe.user.id}
Method: ${method}
Number: ${number}
Amount: ${amount}‡ß≥`;

  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${ADMIN_ID}&text=` +
    encodeURIComponent(msg)
  );

  balance -= amount;
  localStorage.setItem("balance", balance);
  document.getElementById("balance").innerText = balance.toFixed(2)+" ‡ß≥";

  alert("Withdraw Request Sent");
  document.getElementById("withdrawBox").style.display = "none";
}

function referral(){
  const link = `https://t.me/maniriyel_bot?start=${tg.initDataUnsafe.user.id}`;
  navigator.clipboard.writeText(link);
  alert("Referral link copied");
}
</script>

</body>
</html>
