<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<title>Earn Money Bot</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Telegram WebApp -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<!-- Ads -->
<script src="//libtl.com/sdk.js" data-zone="10390731" data-sdk="show_10390731"></script>
<script src="https://adexora.com/cdn/ads.js?id=1551"></script>

<style>
body{margin:0;font-family:Arial;background:#f6f7fb;}
.header{background:#ff4fa3;color:#fff;padding:18px;text-align:center;font-size:20px;}
.fixed-balance{background:#fff;margin:10px;padding:10px;border-radius:10px;text-align:center;font-weight:bold;}
.container{padding:15px;}
.card{background:#fff;border-radius:12px;padding:15px;margin-bottom:15px;box-shadow:0 2px 6px rgba(0,0,0,.08);}
.balance{font-size:28px;font-weight:bold;text-align:center;}
.btn{width:100%;padding:14px;border:none;border-radius:10px;font-size:16px;color:#fff;margin-top:10px;}
.btn-monetag{background:#3f5bd8;}
.btn-adexora{background:#9c27b0;}
.btn-withdraw{background:#28a745;}
.small{font-size:12px;color:#555;text-align:center;}
.hide{display:none;}
.nav{position:fixed;bottom:0;left:0;width:100%;display:flex;background:#ff4fa3;}
.nav button{flex:1;padding:12px;border:none;background:none;color:#fff;}
.toast{display:none;position:fixed;top:15px;left:50%;transform:translateX(-50%);padding:10px 18px;border-radius:20px;color:#fff;z-index:999;}
</style>
</head>

<body>

<div class="toast" id="toast"></div>

<div class="header">üí∞ Earn Money Bot</div>
<div class="fixed-balance">Balance: <span id="balanceFixed">0.00</span> ‡ß≥</div>

<div class="container" id="home">
  <div class="card">
    <div class="balance" id="balance">0.00 ‡ß≥</div>
    <div style="text-align:center;">Total Balance</div>
  </div>

  <div class="card" style="text-align:center;">
    ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶≤‡ßá ‡ßß‡ß¶% ‡¶™‡¶æ‡¶∞‡¶∏‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶Æ‡¶ø‡¶∂‡¶® ‡¶™‡¶æ‡¶¨‡ßá‡¶®
  </div>

  <div class="card">
    <button class="btn btn-monetag" onclick="showTab('earn')">Earn</button>
    <button class="btn btn-adexora" onclick="showTab('withdraw')">Withdraw</button>
  </div>
</div>

<div class="container hide" id="earn">
  <div class="card">
    <button class="btn btn-monetag" onclick="watchMonetag()">üì∫ Watch Ad (Monetag)</button>
    <button class="btn btn-adexora" onclick="watchAdexora()">üì∫ Watch Ad (Adexora)</button>
  </div>
</div>

<div class="container hide" id="withdraw">
  <div class="card">
    <select id="method">
      <option>Bkash</option>
      <option>Nagad</option>
    </select>
    <input id="amount" type="number" placeholder="Withdraw Amount">
    <button class="btn btn-withdraw" onclick="withdraw()">Submit Withdraw</button>
  </div>
</div>

<div class="nav">
  <button onclick="showTab('home')">Home</button>
  <button onclick="showTab('earn')">Earn</button>
  <button onclick="showTab('withdraw')">Withdraw</button>
</div>

<script type="module">
/* ================= FIREBASE ================= */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, onValue, get, push, update } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
 apiKey: "AIzaSyBuXO7NeHZzhgxJzvu8Q13AcojG5mkCxQA",
 authDomain: "maniriyelbot.firebaseapp.com",
 databaseURL: "https://maniriyelbot-default-rtdb.firebaseio.com",
 projectId: "maniriyelbot",
 storageBucket: "maniriyelbot.firebasestorage.app",
 messagingSenderId: "245853450613",
 appId: "1:245853450613:web:b2a96e8dcaadb8de67233c"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

/* ================= TELEGRAM UID ================= */
const tg = window.Telegram.WebApp;
tg.ready();
const uid = tg.initDataUnsafe.user.id;

/* ================= USER DATA ================= */
const userRef = ref(db,"users/"+uid);
const settingsRef = ref(db,"settings");

let balance = 0;
let settings = {};

onValue(userRef,s=>{
 const d=s.val()||{};
 if(d.banned){
   alert("üö´ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶¨‡¶®‡ßç‡¶ß");
   tg.close();
 }
 balance=d.balance||0;
 updateUI();
});

onValue(settingsRef,s=>{
 settings=s.val()||{};
});

/* ================= UI ================= */
function updateUI(){
 document.getElementById("balance").innerText=balance.toFixed(2)+" ‡ß≥";
 document.getElementById("balanceFixed").innerText=balance.toFixed(2);
}

function toast(msg,ok){
 const t=document.getElementById("toast");
 t.innerText=msg;
 t.style.background=ok?"#2e7d32":"#d32f2f";
 t.style.display="block";
 setTimeout(()=>t.style.display="none",2500);
}

/* ================= ADS ================= */
function watchMonetag(){
 if(settings.bot==="off") return toast("‚ùå Bot ‡¶¨‡¶®‡ßç‡¶ß",false);
 show_10390731().then(()=>{
   setTimeout(addReward,18000);
 });
}

function watchAdexora(){
 if(settings.bot==="off") return toast("‚ùå Bot ‡¶¨‡¶®‡ßç‡¶ß",false);
 showAdexora().then(()=>{
   setTimeout(addReward,18000);
 });
}

function addReward(){
 if(settings.adReward?.status!=="on") return;
 const r=settings.adReward?.amount||0;
 update(userRef,{balance:balance+r});
}

/* ================= WITHDRAW ================= */
function withdraw(){
 const min=settings.minWithdraw||50;
 const amt=Number(amount.value);
 if(amt<min) return toast(`‡¶®‡ßç‡¶Ø‡ßÇ‡¶®‡¶§‡¶Æ ${min} ‡¶ü‡¶æ‡¶ï‡¶æ`,false);
 if(balance<amt) return toast("‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶§ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶®‡ßá‡¶á",false);

 push(ref(db,"withdraws"),{
   uid,amount:amt,method:method.value,status:"pending"
 });
 update(userRef,{balance:balance-amt});
 toast("‚úÖ Success! ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ Withdraw Pending",true);
 amount.value="";
}

/* ================= NAV ================= */
function showTab(id){
 ["home","earn","withdraw"].forEach(x=>document.getElementById(x).classList.add("hide"));
 document.getElementById(id).classList.remove("hide");
}
window.showTab=showTab;
</script>

</body>
</html>
